---
include:
  - https://salsa.debian.org/salsa-ci-team/pipeline/raw/master/recipes/debian.yml

variables:
  # Use the nocheck build profile to keep the build time under 3h given the
  # slowness of salsa runners
  DEB_BUILD_OPTIONS: 'nocheck'

  # The salsa runners are too slow to run autopkgtest in less than 3h
  SALSA_CI_DISABLE_AUTOPKGTEST: 1

  # It is expected that build flags are slightly different from the dpkg-buildflags ones
  SALSA_CI_DISABLE_BLHC: 1

  # The salsa runners are too slow to build glibc twice in less than 3h, even with nocheck
  SALSA_CI_DISABLE_REPROTEST: 1

  # These are a wrong positive from lintian:
  # - shared-library-is-executable can't be overriden for udeb packages
  # - unpack-message-for-deb-data can't be overriden due to multiarch (see #1099166, #1099167)
  SALSA_CI_LINTIAN_SUPPRESS_TAGS: 'shared-library-is-executable,unpack-message-for-deb-data'

build:
  extends: .build-package
  timeout: 3h

build arm64:
  extends: .build-package-arm64
  rules:
    - if: $CI_PROJECT_ROOT_NAMESPACE  == "glibc-team"
